---
title: "Resultados IDX 1: Acceso a servicio de agua potable y saneamiento"
format: html
---

**Resumen:**
Esta página presenta el análisis y los resultados del Índice de Acceso a Servicios de Agua Potable y Saneamiento para los municipios de Antioquia. Se describe la metodología utilizada, se muestran estadísticas descriptivas de las variables involucradas, se explica la construcción del índice mediante análisis de componentes principales (PCA) y se presentan los resultados numéricos y espaciales. Además, se facilita la descarga de la base de datos y los gráficos generados, así como el acceso al código fuente empleado en el estudio.

## Resultados para Antioquia

Aquí se presenta los resultados usando todos los datos para el departmento

## Estadísticas descriptivas

A continuación se muestran las estadísticas descriptivas de las variables que componen el índice. Se incluyen medidas como la media, desviación estándar, mínimo y máximo para cada variable relevante.

```{r}
library(readxl)
library(knitr)
library(magrittr) # <- Esto habilita %>%

# Ruta al archivo exportado por AUX_Functions
ruta_excel <- "all/01_TablasDescriptivas/idx1_servicio_summary_labels.xlsx"

# Leer el archivo
tabla_resumen <- read_xlsx(ruta_excel)

# Mostrar la tabla con etiquetas legibles y tres decimales
tabla_resumen %>%
  dplyr::select(Etiqueta, N, Media, SD, Min, Max) %>%
  dplyr::mutate(
    Media = round(Media, 3),
    SD = round(SD, 3),
    Min = round(Min, 3),
    Max = round(Max, 3)
  ) %>%
  kable(caption = "Resumen de variables numéricas válidas")
```

---


## Construcción del índice

Se empleó análisis de componentes principales (PCA) para identificar los factores más relevantes que explican el acceso a servicios de agua potable y saneamiento. A continuación se presentan los principales componentes extraídos y las variables con mayor peso en cada uno.

<div style="display: flex; gap: 10px; justify-content: center; align-items: center;">
  <img src="all/idx1_servicio_radar_PC1.png" width="300px" />
  <img src="all/idx1_servicio_radar_PC2.png" width="300px" />
  <img src="all/idx1_servicio_radar_PC3.png" width="300px" />
  <img src="all/idx1_servicio_radar_PC4.png" width="300px" />
</div>

```{r, fig.cap = 'Resultados completos en PNG'}
knitr::include_graphics("all/02_Imagenes/idx1_servicio_results.png")
```

---


### Resultados numéricos

Se presentan las cargas por variable y componente, la varianza explicada y las variables más influyentes en los principales componentes.

```{r, echo=FALSE}
library(readxl)
library(knitr)

# Ruta al archivo Excel
ruta_excel <- "all/idx1_servicio_loadings_y_tops.xlsx"

# Leer las hojas
loadings <- read_xlsx(ruta_excel, sheet = "loadings")
variance <- read_xlsx(ruta_excel, sheet = "variance")
top_PC1 <- read_xlsx(ruta_excel, sheet = "top_PC1")
top_PC2 <- read_xlsx(ruta_excel, sheet = "top_PC2")

# Mostrar tablas
kable(loadings, caption = "Cargas por variable y componente (loadings)")
kable(variance, caption = "Varianza explicada por componente")
kable(top_PC1, caption = "Top variables en PC1")
kable(top_PC2, caption = "Top variables en PC2")
```


---


### Distribución espacial

El siguiente mapa muestra la distribución espacial de los índices 1 y 2, agrupados por cuartiles en los municipios de Antioquia.

```{r, fig.cap = 'Mapa combinado de componentes principales', echo=FALSE}
knitr::include_graphics("all/02_Imagenes/idx1_servicio_map_pcall.png")
```


## Descarga de datos

Puedes descargar la base de datos asociada a este índice aquí:
[Descargar base de datos IDX 1](/03_DS/idx1_servicio.xlsx)

---

## Descarga de gráficos y acceso a código fuente

<div class="btn-group" role="group">
  <a href="all/idx1_servicio_radar_PC1.png" class="btn btn-primary" download>Descargar Radar PC1</a>
  <a href="all/idx1_servicio_radar_PC2.png" class="btn btn-primary" download>Descargar Radar PC2</a>
  <a href="all/idx1_servicio_radar_PC3.png" class="btn btn-primary" download>Descargar Radar PC3</a>
  <a href="all/02_Imagenes/idx1_servicio_map_pc1.png" class="btn btn-info" download>Descargar Mapa PC1</a>
  <a href="all/02_Imagenes/idx1_servicio_map_pc2.png" class="btn btn-info" download>Descargar Mapa PC2</a>
  <a href="all/02_Imagenes/idx1_servicio_map_pcall.png" class="btn btn-info" download>Descargar Mapa Todos los PCs</a>
  <a href="all/02_Imagenes/idx1_servicio_results.png" class="btn btn-success" download>Descargar Resultados Completos</a>
  <a href="all/idx1_servicio_loadings_y_tops.xlsx" class="btn btn-warning" download>Descargar Excel de Loadings y Tops</a>
  <a href="all/01_TablasDescriptivas/idx1_servicio_summary_labels.xlsx" class="btn btn-warning" download>Descargar Tabla Descriptiva</a>
</div>

<div class="btn-group" role="group">
  <a href="https://github.com/jcmunozmora/pulso_antioquia/tree/main/02_Code/AUX_Functions.R" class="btn btn-dark" target="_blank">Ver código fuente en GitHub</a>
  <a href="https://github.com/jcmunozmora/pulso_antioquia" class="btn btn-dark" target="_blank">Repositorio principal</a>
</div>
